<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Question</title>
  <link rel="icon" href="assets/favicon.png" />
  <link rel="stylesheet" href="css/question.css" />
  <link rel="stylesheet" href="css/game.css" />
  <style>
    .explanation-container {
      padding: 20px;
      margin-top: 10px;
      background-color: #f9f9f9;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }

    .explanation-text {
      font-size: 16px;
      color: #333;
    }

    .retry-button {
      font-size: 16px;
      padding: 10px 20px;
      margin-top: 10px;
      margin-bottom: 16px;
      cursor: pointer;
      background-color: #007bff;
      color: #fff;
      border: none;
      border-radius: 4px;
      transition: background-color 0.3s ease;
    }

    .retry-button:hover {
      background-color: #0056b3;
    }
  </style>
</head>

<body>
  <div class="container">
    <div id="game" class="justify-center flex-column">
      <div id="hud">
        <div class="hud-item">
          <p id="progressText" class="hud-prefix">Question</p>
          <div id="progressBar">
            <div id="progressBarFull"></div>
          </div>
        </div>
        <div class="hud-item">
          <p class="hud-prefix">Score</p>
          <h1 class="hud-main-text" id="score">0</h1>
        </div>
      </div>
      <h1 id="question">What is the answer to this question?</h1>
      <div class="choice-container">
        <p class="choice-prefix">A</p>
        <p class="choice-text" data-number="1">Choice 1</p>
      </div>
      <div class="choice-container">
        <p class="choice-prefix">B</p>
        <p class="choice-text" data-number="2">Choice 2</p>
      </div>
      <div class="choice-container">
        <p class="choice-prefix">C</p>
        <p class="choice-text" data-number="3">Choice 3</p>
      </div>
      <div class="choice-container">
        <p class="choice-prefix">D</p>
        <p class="choice-text" data-number="4">Choice 4</p>
      </div>
      <div id="explanation" class="hidden explanation-container">
        <p id="explanationText" class="explanation-text"></p>
        <button id="retryButton" class="retry-button" onclick="retryQuestion()">Try Again</button>
      </div>
    </div>
  </div>

  <script>
    const question = document.querySelector("#question");
    const choices = Array.from(document.querySelectorAll(".choice-text"));
    const progressText = document.querySelector("#progressText");
    const scoreText = document.querySelector("#score");
    const progressBarFull = document.querySelector("#progressBarFull");
    const explanationElement = document.querySelector("#explanation");
    const explanationText = document.querySelector("#explanationText");
    const retryButton = document.querySelector("#retryButton");

    let currentQuestion = {};
    let acceptingAnswers = true;
    let score = 0;
    let questionCounter = 0;
    let availableQuestions = [];
    let retries = 0;
    let retryScore = 200;
    let questions = [
    {
      question: "What should you do if someone you don't know sends you a friend request with a suspicious profile?",
      choice1: "Accept it to be polite.",
      choice2: "Message them to ask who they are.",
      choice3: "Ignore or block the request.",
      choice4: "Share your account details to see if they're trustworthy.",
      answer: 3,
      explanation: "You should ignore or block suspicious requests. Accepting unknown users can lead to privacy and security risks."
    },
    {
      question: "Why should you avoid posting your exact location on social media in real time?",
      choice1: "It makes your posts less exciting.",
      choice2: "It could help others track your routine or current whereabouts.",
      choice3: "It uses too much data.",
      choice4: "Friends wonâ€™t be able to meet you there.",
      answer: 2,
      explanation: "Posting your real-time location can allow strangers or criminals to track you, putting your safety at risk."
    },
    {
      question: "What is the best response to someone pressuring you to send private photos on social media?",
      choice1: "Send the photo but ask them not to share it.",
      choice2: "Block and report the person immediately.",
      choice3: "Tell a friend about it but keep them on your list.",
      choice4: "Ignore it and hope it stops.",
      answer: 2,
      explanation: "Block and report anyone who pressures you. It's a serious red flag for manipulation or exploitation."
    },
    {
      question: "Why is setting your social media account to private a safer option than keeping it public?",
      choice1: "It makes your profile look cooler.",
      choice2: "It allows only your friends to see your posts and personal information.",
      choice3: "Public accounts help you get more followers quickly.",
      choice4: "Private accounts are harder to use.",
      answer: 2,
      explanation: "Private accounts limit who can see your content, helping you stay safer by avoiding strangers viewing your posts."
    }
  ];

    const SCORE_POINTS = 200;
    const MAX_QUESTIONS = questions.length;

    startGame = () => {
      questionCounter = 0;
      score = 0;
      availableQuestions = [...questions];
      getNewQuestion();
    };

    getNewQuestion = () => {
      retries = 0;
      retryScore = SCORE_POINTS;
      explanationElement.classList.add("hidden");

      if (questionCounter >= MAX_QUESTIONS) {
        localStorage.setItem("mostRecentScore", score);
        return window.location.assign("save_game.html");
      }

      questionCounter++;
      progressText.innerText = `Question ${questionCounter} of ${MAX_QUESTIONS}`;
      progressBarFull.style.width = `${(questionCounter / MAX_QUESTIONS) * 100}%`;

      currentQuestion = availableQuestions[questionCounter - 1];
      question.innerText = currentQuestion.question;

      choices.forEach((choice) => {
        const number = choice.dataset["number"];
        choice.innerText = currentQuestion["choice" + number];
        choice.parentElement.classList.remove("correct", "incorrect");
      });

      acceptingAnswers = true;
    };

    choices.forEach((choice) => {
      choice.addEventListener("click", (e) => {
        if (!acceptingAnswers) return;

        acceptingAnswers = false;
        const selectedChoice = e.target;
        const selectedAnswer = selectedChoice.dataset["number"];
        let classToApply = selectedAnswer == currentQuestion.answer ? "correct" : "incorrect";

        selectedChoice.parentElement.classList.add(classToApply);

        if (classToApply === "correct") {
          incrementScore(retryScore);
          setTimeout(() => {
            getNewQuestion();
          }, 1000);
        } else {
          retryScore -= 100;
          if (retryScore < 0) retryScore = 0;

          explanationText.innerText = currentQuestion.explanation;
          explanationElement.classList.remove("hidden");
          retries++;

          if (retries < 3) {
            acceptingAnswers = true;
          } else {
            setTimeout(() => {
              getNewQuestion();
            }, 1000);
          }
        }
      });
    });

    retryQuestion = () => {
      if (retries >= 3) {
        return;
      }

      const selectedChoice = document.querySelector(".incorrect");
      if (selectedChoice) {
        selectedChoice.classList.remove("incorrect");
      }

      explanationElement.classList.add("hidden");
      acceptingAnswers = true;
    };

    incrementScore = (num) => {
      score += num;
      scoreText.innerText = score;
    };

    startGame();
  </script>
</body>


</html>